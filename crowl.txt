private void importIntoCoreDatabase(Path path, String tableName) {
    try (Connection connection = DriverManager.getConnection(coreDbUrl, coreDbUsername, coreDbPassword);
         InputStream inputStream = Files.newInputStream(path)) {
        connection.setAutoCommit(false);
        try (CopyManager copyManager = new CopyManager((BaseConnection) connection)) {
            copyManager.copyIn("COPY core." + tableName + " (data) FROM STDIN WITH (FORMAT CSV, HEADER)", inputStream);
        }
        connection.commit();
        logger.info("Импортирован файл {} в бд Core, добавлена новая таблица {}", path.getFileName(), tableName);
    } catch (SQLException | IOException e) {
        logger.error("Ошибка импортирования файла {} в бд Core", path.getFileName(), e);
    }
}

private void importIntoOisDatabase(Path path, String tableName) {
    try (Connection connection = DriverManager.getConnection(oisDbUrl, oisDbUsername, oisDbPassword);
         InputStream inputStream = Files.newInputStream(path)) {
        connection.setAutoCommit(false);
        try (CopyManager copyManager = new CopyManager((BaseConnection) connection)) {
            copyManager.copyIn("COPY ois." + tableName + " (data) FROM STDIN WITH (FORMAT CSV, HEADER)", inputStream);
        }
        connection.commit();
        logger.info("Импортирован файл {} в бд OIS, добавлена новая таблица {}", path.getFileName(), tableName);
    } catch (SQLException | IOException e) {
        logger.error("Ошибка импортирования файла {} в бд OIS ", path.getFileName(), e);
    }
