@EventListener(ApplicationReadyEvent.class)
public void updateParameters() {
    logger.info("Обновление параметров updateParameters()");
    Parameters parameters = cacheService.getParameters();
    
    // Обновляем параметры приложения
    timerDelay = parameters.getParametersUpdateDelay();
    delay = parameters.getFileMonitorDelay();
    folderPath = parameters.getFileMonitorFolder();
    dateFormat = parameters.getFileValidatorDateMask();
    refreshRate = parameters.getRefreshRate(); // Частота обновления параметров

    // Обновляем параметры FolderCleaner
    long folderCleanerDelay = parameters.getFolderCleanerDelay(); // Задержка для FolderCleaner
    watchedDirectoryPath = parameters.getCleanerFolder();
    daysToExpire = parameters.getDaysToExpire();
    
    // Запускаем FolderCleaner с новым значением задержки
    folderCleaner.startCleaningProcess(watchedDirectoryPath, folderCleanerDelay, daysToExpire);
    
    // Обновляем другие компоненты
    updateFileMonitor();
    updateFileValidator();

    // Запускаем таймер для обновления параметров
    TimerTask task = new TimerTask() {
        public void run() {
            updateParameters();
        }
    };
    Timer timer = new Timer("Timer");
    timer.schedule(task, refreshRate); // Задержка для обновления параметров
}






public void startCleaningProcess(String watchedDirectoryPath, long folderCleanerDelay, int daysToExpire) {
    // Обновляем параметры
    this.watchedDirectoryPath = watchedDirectoryPath;
    this.daysToExpire = daysToExpire;
    logger.info("Запущен процесс очистки: watchedDirectoryPath = {}, cleanerDelay = {}, daysToExpire = {}",
            watchedDirectoryPath, folderCleanerDelay, daysToExpire);
    
    // Останавливаем существующий таймер, если он есть
    if (cleanerTimer != null) {
        cleanerTimer.cancel();
    }

    // Запускаем новый таймер
    cleanerTimer = new Timer("FolderCleanerTimer");

    TimerTask task = new TimerTask() {
        public void run() {
            cleanFolder();
        }
    };
    cleanerTimer.scheduleAtFixedRate(task, 0, folderCleanerDelay); // Используйте folderCleanerDelay
}




